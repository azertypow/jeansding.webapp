import{d as k,s as g,i as C,_ as b,o as t,c as i,A as j,j as y,r as A,a as u,F as m,b as _,e as a,t as S,f as I,w as $,n as L,g as h,h as w}from"./index.678753b8.js";const M=k({name:"ArticleBlock",components:{},data(){return{footNoteElements:[]}},props:{html:{required:!0,type:String}},async mounted(){this.$refs.articleBlockContainer.append(await this.getArticleContentHtmlElement())},beforeUnmount(){g().clearFootNoteListAndRemoveScrollListener()},computed:{htmlCleanGallery(){const e=document.createElement("div");if(e.innerHTML=this.html,!(e instanceof HTMLElement))return"";const r=e.querySelectorAll("figure");for(const l of r){const s=document.createElement("div");s.className="jd-gallery-img",l.querySelectorAll("img").forEach(c=>{s.appendChild(c.cloneNode(!0))}),e.insertBefore(s,l),l.remove()}return e.innerHTML}},methods:{async getArticleContentHtmlElement(){const r=new DOMParser().parseFromString(`<div class="v-article-block__html"  >${this.htmlCleanGallery}</div>`,"text/html");r.querySelectorAll("article-footnote").forEach(o=>{g().pushFooterNoteElement(r,o),o.remove()});const l=r.querySelectorAll("img"),c=`mediapage/${this.$router.currentRoute.value.fullPath.replace("/projects/","")}`;for(const o of l){const v=o.src.split("/").pop()||"";o.classList.add("is-loading"),o.src="",C({articleName:c,fileName:v}).then(d=>{o.src=d.resize.tiny;const n=new Image;n.src=d.resize.reg,n.addEventListener("load",()=>{o.src=n.src,o.classList.add("is-load")})})}const p=r.querySelectorAll("figure");return Object.values(p).forEach(o=>{o.querySelectorAll("ul > li > img").length===1&&o.classList.add("ts-article-block-has-only-one-image")}),r.body.firstElementChild}}});const T={class:"v-article-block",ref:"articleBlockContainer"};function E(e,r,l,s,c,p){return t(),i("div",T,null,512)}const F=b(M,[["render",E]]),H=k({components:{ArticleBlock:F,ArticleContainer:j},data(){return{globalState:g(),video:""}},mounted(){this.$nextTick(()=>{this.setVideo()})},methods:{async setVideo(){if(!this.currentArticle||this.currentArticle.vimeoLink===null)return null;const e="https://vimeo.com/api/oembed.json?autopip=1&title=0&byline=0&responsive=1&portrait=0&color=A04600&url="+encodeURI(this.currentArticle.vimeoLink);this.video=(await(await window.fetch(e)).json()).html},getShortedItemForColumn(e){const r=[];return Object.values(this.globalState.apiProjects[this.currentSectionUID].children).filter(l=>l.uid!==this.$route.params.articleUid).forEach((l,s)=>{const c=s%e;r[c]=Array.isArray(r[c])?[...r[c],l]:[l]}),r}},computed:{apiProjects(){return this.globalState.apiProjects},currentArticle(){var e;return(e=this.apiProjects[this.projectSection])==null?void 0:e.children["mediapage/"+this.projectSection+"/"+this.articleUid]},italicMarkdownCurrentArticleTitleAndSubtitle(){if(this.currentArticle===null)return null;const e=this.currentArticle.title?y(this.currentArticle.title):"",r=this.currentArticle.subtitle?"<br>"+y(this.currentArticle.subtitle):"";return e+r},projectSection(){return this.$route.params.projectSection},articleUid(){return this.$route.params.articleUid},currentSectionUID(){return this.$route.params.projectSection}}});const U={class:"v-article"},B={class:"v-article__header"},N={key:0,class:"v-article__content"},P=["innerHTML"],q={class:"v-article__content__header"},D=["innerHTML"],V=["innerHTML"],R={key:1},z={class:"v-article__blocks"},G={key:1,class:"v-article__item"},O={class:"v-article__item__coll"},W={class:"v-article__item__grid"},J={class:"v-article__item__coll"},K={class:"v-article__item__grid"},Q={class:"v-article__item__coll"},X={class:"v-article__item__grid"};function Y(e,r,l,s,c,p){const o=A("router-link"),v=A("article-block"),d=A("article-container");return t(),i("div",U,[u("header",B,[(t(!0),i(m,null,_(e.apiProjects,(n,f)=>(t(),I(o,{class:L([{"is-active":f===e.currentSectionUID},"jd-button"]),to:"/projects/"+f},{default:$(()=>[w(S(n.title),1)]),_:2},1032,["class","to"]))),256))]),e.currentArticle?(t(),i("div",N,[e.currentArticle.vimeoLink?(t(),i("div",{key:0,class:"v-article__content__vimeo-box",innerHTML:e.video},null,8,P)):a("",!0),u("div",q,[u("div",{class:"v-article__content__description jd-text-max-width-reg",innerHTML:e.currentArticle.description},null,8,D),e.italicMarkdownCurrentArticleTitleAndSubtitle?(t(),i("h1",{key:0,innerHTML:e.italicMarkdownCurrentArticleTitleAndSubtitle},null,8,V)):a("",!0),e.currentArticle.author?(t(),i("h2",R,S(e.currentArticle.author),1)):a("",!0)]),(t(!0),i(m,null,_(e.currentArticle.article_content,n=>(t(),i("div",z,[h(v,{html:n},null,8,["html"])]))),256))])):a("",!0),e.globalState.apiProjects[e.currentSectionUID]?(t(),i("section",G,[u("div",O,[e.getShortedItemForColumn(3)[0]?(t(!0),i(m,{key:0},_(e.getShortedItemForColumn(3)[0],n=>(t(),i("div",W,[h(d,{style:{"border-bottom":"none"},"article-data":n},null,8,["article-data"])]))),256)):a("",!0)]),u("div",J,[e.getShortedItemForColumn(3)[1]?(t(!0),i(m,{key:0},_(e.getShortedItemForColumn(3)[1],n=>(t(),i("div",K,[h(d,{style:{"border-bottom":"none"},"article-data":n},null,8,["article-data"])]))),256)):a("",!0)]),u("div",Q,[e.getShortedItemForColumn(3)[2]?(t(!0),i(m,{key:0},_(e.getShortedItemForColumn(3)[2],n=>(t(),i("div",X,[h(d,{style:{"border-bottom":"none"},"article-data":n},null,8,["article-data"])]))),256)):a("",!0)])])):a("",!0)])}const x=b(H,[["render",Y]]);export{x as default};
