import{d as S,s as g,i as C,_ as y,o as e,c as r,A as j,j as b,r as A,a as d,F as u,b as _,e as c,t as f,f as I,w as $,n as w,g as h,h as L}from"./index.aa1f1bc1.js";const M=S({name:"ArticleBlock",components:{},data(){return{footNoteElements:[]}},props:{html:{required:!0,type:String}},async mounted(){this.$refs.articleBlockContainer.append(await this.getArticleContentHtmlElement())},beforeUnmount(){g().clearFootNoteListAndRemoveScrollListener()},methods:{async getArticleContentHtmlElement(){const i=new DOMParser().parseFromString(`<div class="v-article-block__html"  >${this.html}</div>`,"text/html");i.querySelectorAll("article-footnote").forEach(o=>{g().pushFooterNoteElement(i,o),o.remove()});const l=i.querySelectorAll("img"),s=`mediapage/${this.$router.currentRoute.value.fullPath.replace("/projects/","")}`;for(const o of l){const v=o.src.split("/").pop()||"";o.classList.add("is-loading"),o.src="",C({articleName:s,fileName:v}).then(a=>{o.src=a.resize.tiny;const n=new Image;n.src=a.resize.reg,n.addEventListener("load",()=>{o.src=n.src,o.classList.add("is-load")})})}const p=i.querySelectorAll("figure");return Object.values(p).forEach(o=>{o.querySelectorAll("ul > li > img").length===1&&o.classList.add("ts-article-block-has-only-one-image")}),i.body.firstElementChild}}});const F={class:"v-article-block",ref:"articleBlockContainer"};function T(t,i,l,m,s,p){return e(),r("div",F,null,512)}const U=y(M,[["render",T]]),E=S({components:{ArticleBlock:U,ArticleContainer:j},data(){return{globalState:g(),video:""}},mounted(){this.$nextTick(()=>{this.setVideo()})},methods:{async setVideo(){if(!this.currentArticle||this.currentArticle.vimeoLink===null)return null;const t="https://vimeo.com/api/oembed.json?autopip=1&title=0&byline=0&responsive=1&portrait=0&color=A04600&url="+encodeURI(this.currentArticle.vimeoLink);this.video=(await(await window.fetch(t)).json()).html},getShortedItemForColumn(t){const i=[];return Object.values(this.globalState.apiProjects[this.currentSectionUID].children).filter(l=>l.uid!==this.$route.params.articleUid).forEach((l,m)=>{const s=m%t;i[s]=Array.isArray(i[s])?[...i[s],l]:[l]}),i}},computed:{apiProjects(){return this.globalState.apiProjects},currentArticle(){var t;return(t=this.apiProjects[this.projectSection])==null?void 0:t.children["mediapage/"+this.projectSection+"/"+this.articleUid]},italicMarkdownCurrentArticleTitleAndSubtitle(){if(this.currentArticle===null)return null;const t=this.currentArticle.title?b(this.currentArticle.title):"",i=this.currentArticle.subtitle?"<br>"+b(this.currentArticle.subtitle):"";return t+i},projectSection(){return this.$route.params.projectSection},articleUid(){return this.$route.params.articleUid},currentSectionUID(){return this.$route.params.projectSection}}});const P={class:"v-article"},B={class:"v-article__header"},H={key:0,class:"v-article__content"},N=["innerHTML"],D={class:"v-article__content__header"},V=["innerHTML"],q=["innerHTML"],R={key:1},z={class:"v-article__blocks"},O={key:1,class:"v-article__item"},W={class:"v-article__item__coll"},G={class:"v-article__item__grid"},J={class:"v-article__item__coll"},K={class:"v-article__item__grid"},Q={class:"v-article__item__coll"},X={class:"v-article__item__grid"};function Y(t,i,l,m,s,p){const o=A("router-link"),v=A("article-block"),a=A("article-container");return e(),r("div",P,[d("header",B,[(e(!0),r(u,null,_(t.apiProjects,(n,k)=>(e(),I(o,{class:w([{"is-active":k===t.currentSectionUID},"jd-button"]),to:"/projects/"+k},{default:$(()=>[L(f(n.title),1)]),_:2},1032,["class","to"]))),256))]),t.currentArticle?(e(),r("div",H,[t.currentArticle.vimeoLink?(e(),r("div",{key:0,class:"v-article__content__vimeo-box",innerHTML:t.video},null,8,N)):c("",!0),d("div",D,[d("div",{class:"v-article__content__description jd-text-max-width-reg",innerHTML:t.currentArticle.description},null,8,V),t.italicMarkdownCurrentArticleTitleAndSubtitle?(e(),r("h1",{key:0,innerHTML:t.italicMarkdownCurrentArticleTitleAndSubtitle},null,8,q)):c("",!0),t.currentArticle.author?(e(),r("h2",R,f(t.currentArticle.author),1)):c("",!0)]),(e(!0),r(u,null,_(t.currentArticle.article_content,n=>(e(),r("div",z,[h(v,{html:n},null,8,["html"])]))),256))])):c("",!0),t.globalState.apiProjects[t.currentSectionUID]?(e(),r("section",O,[d("div",W,[t.getShortedItemForColumn(3)[0]?(e(!0),r(u,{key:0},_(t.getShortedItemForColumn(3)[0],n=>(e(),r("div",G,[h(a,{style:{"border-bottom":"none"},"article-data":n},null,8,["article-data"])]))),256)):c("",!0)]),d("div",J,[t.getShortedItemForColumn(3)[1]?(e(!0),r(u,{key:0},_(t.getShortedItemForColumn(3)[1],n=>(e(),r("div",K,[h(a,{style:{"border-bottom":"none"},"article-data":n},null,8,["article-data"])]))),256)):c("",!0)]),d("div",Q,[t.getShortedItemForColumn(3)[2]?(e(!0),r(u,{key:0},_(t.getShortedItemForColumn(3)[2],n=>(e(),r("div",X,[h(a,{style:{"border-bottom":"none"},"article-data":n},null,8,["article-data"])]))),256)):c("",!0)])])):c("",!0)])}const x=y(E,[["render",Y]]);export{x as default};
